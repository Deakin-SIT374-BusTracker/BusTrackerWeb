@*View Layout and Header*@
@{
    Layout = "~/Views/Shared/_Layout.cshtml";

    // Link Twitter Typeahead CSS.
}



@* View HTML Body*@
@* Bus Hop Search - Logo *@
<div style="margin-top:1.5em">
    <img src="~/Content/Images/bushop-logo.png" class="img-responsive" style="margin:0 auto; width:12em" />
</div>

@* Bus Hop Search - Destination TypeAhead and Search Button *@
<div>
    <div class="search-title">Where are you travelling to?</div>
    <form>
        <div class="form-group">
            <div id="search-hints">
                <input id="search-input" type="text" class="typeahead form-control search-destination" placeholder="Destination">
            </div>
            <button id="searchButton" type="button" class="search-button btn btn-primary">Search</button>
        </div>
    </form>
</div>


@* Bus Hop Search - Results Partial View Placeholder *@
<div class="search-table" id="searchResults"></div>


@* View Javascripts (Called after HTML Body)*@
@section scripts {
    @* Include Twitter Typeahead Javascript Package *@
    <script type="text/javascript" src="~/Scripts/typeahead.js"></script>

    <script>
        /*
        Function: document.Ready()
        Jquery function called after document has been rendered.
        */
        $(function () {
            var countries = new Bloodhound({
                datumTokenizer: Bloodhound.tokenizers.whitespace,
                queryTokenizer: Bloodhound.tokenizers.whitespace,
                prefetch: {
                    url: '/Search/SearchHints?q=%QUERY&nocache=' + (new Date()).getTime(),
                    wildcard: '%QUERY'
                }
            });

            $('#search-hints .typeahead').typeahead(null, {
                name: 'hints',
                source: countries
            });
        });
    </script>

    <script>
        /*
        Function: searchButton.click()
        Use Jquery to get the search results partial view.
        */
        $('#searchButton').click(function () {
            $.get("/Search/SearchRoutes", { destination: $("#search-input").val() }, function (response) {
                $("#searchResults").html(response);
            });
        });
    </script>
}
